
# ICMP Tunnel Manager (Hossein.IT)
<img src="icmptunnel" alt="icmp tunnel">

ฺฉ ุงุณฺฉุฑูพุช Bash ุจุฑุง ุณุงุฎุช ุชููู **ICMP (Ping Tunnel)** ุจู ุฏู ุณุฑูุฑ Ubuntu:  
- **ุณุฑูุฑ ุงุฑุงู = Client**  
- **ุณุฑูุฑ ุฎุงุฑุฌ = Server**  
ุจูโุทูุฑโฺฉู ุชูุงู ุชุฑุงูฺฉ ุณุฑูุฑ ุงุฑุงู ุงุฒ ุทุฑู ุณุฑูุฑ ุฎุงุฑุฌ ุนุจูุฑ ฺฉูุฏ.

## ูุงูโูุง
- `icmp-tunnel.sh` โ ุงุณฺฉุฑูพุช ุชุนุงูู ุจุง ููู ุฑูฺฏุ ูุตุจ ุฎูุฏฺฉุงุฑุ ุณุฑูุณ systemdุ NAT ู ูพุงฺฉุณุงุฒ.

## ุงุฌุฑุง ุณุฑุน๐
ุฑู ูุฑ ุณุฑูุฑ (ุจุง `sudo` ุงุฌุฑุง ฺฉูุฏ):
```bash
bash <(curl -fsSL https://raw.githubusercontent.com/hosseinit1988/ICMP-Tunnel-Ubuntu/main/icmp-tunnel.sh)
chmod +x icmp-tunnel.sh
sudo ./icmp-tunnel.sh
```
ุณูพุณ ุงุฒ ููู:
1. ุฑู ุณุฑูุฑ ุงุฑุงู ฺฏุฒูู **1 (Client)** ุฑุง ุจุฒูุฏ ู IP ุณุฑูุฑ ุขููุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ.  
2. ุฑู ุณุฑูุฑ ุฎุงุฑุฌ ฺฏุฒูู **2 (Server)** ุฑุง ุจุฒูุฏ.

> ูพุณ ุงุฒ ุฑุงูโุงูุฏุงุฒุ ุณุฑูุณโูุง ูพุงุฏุงุฑ ูุณุชูุฏ ู ูพุณ ุงุฒ ุฑุจูุช ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุจุงูุง ูโุขูุฏ.

## ุฌุฒุฆุงุช ูู
- ุฑูพู ุณูุฑุณ: `https://github.com/DhavalKapil/icmptunnel`
- ุงูุชุฑูุณ ุงูุชุฑูุช ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุดูุงุณุง ูโุดูุฏ.
- ุขุฏุฑุณโูุง ุชููู:
  - Server (ุฎุงุฑุฌ): `10.0.0.1/24`
  - Client (ุงุฑุงู): `10.0.0.2/24`
- ุฑู ุณุฑูุฑ ุฎุงุฑุฌ: `IP Forwarding` ุจูโุตูุฑุช ูพุงุฏุงุฑ ูุนุงู ูโุดูุฏ ู `MASQUERADE` ุฑู ุงูุชุฑูุณ ุงูุชุฑูุช ุชูุธู ูโฺฏุฑุฏุฏ.
- ุฑู ุณุฑูุฑ ุงุฑุงู: ูุณุฑ ูพุดโูุฑุถ ุจู ุณูุช `10.0.0.1` ุฑู `tun0` ุชูุธู ูโุดูุฏ.

## ุฏุณุชูุฑุงุช ููุฏ๐
ููุงุด ูุถุนุช:
```bash
systemctl status icmptunnel
```
ุชููู/ุดุฑูุน:
```bash
sudo systemctl stop icmptunnel
sudo systemctl start icmptunnel
```

## ุญุฐู ฺฉุงูู ุชููู
ุงุฒ ููู ฺฏุฒูู **4** ุฑุง ุจุฒูุฏ ุง:
```bash
sudo systemctl stop icmptunnel
sudo systemctl disable icmptunnel
sudo rm -f /etc/systemd/system/icmptunnel.service
sudo systemctl daemon-reload
sudo pkill -x icmptunnel || true
sudo ip link set tun0 down || true
sudo ip route del default via 10.0.0.1 dev tun0 || true
sudo iptables -t nat -D POSTROUTING -o <iface> -j MASQUERADE  # ุฏุฑ ุตูุฑุช ูุฌูุฏ
sudo rm -f /etc/sysctl.d/99-icmp-tunnel.conf && sudo sysctl --system
```

## ูฺฉุงุช ู ุฑูุน ุงุดฺฉุงู๐
- ุงฺฏุฑ ูุงุฑูุงู/ACL ุดุจฺฉู ICMP ุฑุง ูุณุฏูุฏ ฺฉุฑุฏู ุจุงุดุฏุ ุชููู ุจุฑูุฑุงุฑ ููโุดูุฏ.
- ุงฺฏุฑ ุฑู ุณุฑูุฑ ุขููุงู ุจูโุฌุง `iptables` ุงุฒ nftables ุงุณุชูุงุฏู ูโฺฉูุฏุ ูุณุชู Ubuntu ุจูโุทูุฑ ูพุดโูุฑุถ iptables (nft) ุฑุง ูฺฏุงุดุช ูโฺฉูุฏ ู ุฏุณุชูุฑูุง ฺฉุงุฑ ูโฺฉููุฏ.
- ุงฺฏุฑ ุงูุชุฑูุณ ุงูุชุฑูุช `eth0` ูุณุชุ ุงุณฺฉุฑูพุช ุขู ุฑุง ุฎูุฏฺฉุงุฑ ุดูุงุณุง ูโฺฉูุฏ.
- ุจุฑุง ูุดุงูุฏู IP ุฎุฑูุฌ ุงุฒ ุณุฑูุฑ ุงุฑุงู:
```bash
curl ifconfig.me
```

## ูุณุฆููุชโ๏ธ
ุงุณุชูุงุฏู ุงุฒ ุชููู ICMP ููฺฉู ุงุณุช ุฏุฑ ุจุฑุฎ ุดุจฺฉูโูุง/ฺฉุดูุฑูุง ูุญุฏูุฏุช ุฏุงุดุชู ุจุงุดุฏ. ูุจู ุงุฒ ุงุณุชูุงุฏูุ ููุงูู ูุญู ู ุณุงุณุชโูุง ุงุฑุงุฆูโุฏููุฏู ุฑุง ุจุฑุฑุณ ฺฉูุฏ.
